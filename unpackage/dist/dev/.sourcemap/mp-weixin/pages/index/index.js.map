{"version":3,"file":"index.js","sources":["pages/index/index.vue","../HBuilder/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvaW5kZXgvaW5kZXgudnVl"],"sourcesContent":["<template>\n  <view>\n    <view class=\"header\">\n      <text class=\"title\">用户报告</text>\n    </view>\n    <view class=\"user-info\" v-if=\"userInfo\">\n      <view class=\"user-avatar\">\n        <image :src=\"userInfo.headimgurl\" mode=\"aspectFill\"></image>\n      </view>\n      <view class=\"user-details\">\n        <text class=\"nickname\">{{ userInfo.nickname }}</text>\n        <text class=\"other-info\"\n          >{{ userInfo.province }} {{ userInfo.city }}</text\n        >\n      </view>\n    </view>\n    <view class=\"loading\" v-else-if=\"loading\">\n      <text>加载中...</text>\n    </view>\n    <view class=\"actions\">\n      <button @click=\"viewHistory\">查看历史检测记录</button>\n      <button @click=\"viewPdfReport\">查看PDF报告</button>\n    </view>\n  </view>\n</template>\n\n<script lang=\"uts\">\nimport { wechatAuth, getStoredUserInfo } from '../../utils/services/wechat';\n\nexport default {\n  data() {\n    return {\n      userInfo: null,\n      loading: true,\n    };\n  },\n  onLoad() {\n    this.initializeAuth();\n  },\n  methods: {\n    async initializeAuth() {\n      try {\n        this.loading = true;\n        // 尝试获取已存储的用户信息\n        const storedInfo = getStoredUserInfo();\n        if (storedInfo) {\n          uni.__f__('log','at pages/index/index.vue:47',4);\n          this.userInfo = storedInfo;\n          this.loading = false;\n          return;\n        }\n\n        // 进行微信授权\n        const userInfo = await wechatAuth();\n        uni.__f__('log','at pages/index/index.vue:55',1);\n        if (userInfo) {\n          this.userInfo = userInfo;\n        }\n      } catch (error) {\n        uni.showToast({\n          title: '授权失败，请重试',\n          icon: 'none',\n        });\n        uni.__f__('error','at pages/index/index.vue:64','授权失败:', error);\n      } finally {\n        this.loading = false;\n      }\n    },\n    viewHistory() {\n      uni.navigateTo({\n        url: '/pages/index/historyRecords/historyRecords',\n      });\n    },\n    viewPdfReport() {\n      // 实现查看PDF报告的逻辑\n      uni.showToast({\n        title: '功能开发中',\n        icon: 'none',\n      });\n    },\n  },\n};\n</script>\n\n<style>\n.header {\n  text-align: center;\n  margin: 20px 0;\n}\n\n.title {\n  font-size: 24px;\n  color: #333;\n}\n\n.user-info {\n  margin: 20px;\n  padding: 15px;\n  background-color: #fff;\n  border-radius: 8px;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n  display: flex;\n  align-items: center;\n}\n\n.user-avatar {\n  width: 60px;\n  height: 60px;\n  margin-right: 15px;\n}\n\n.user-avatar image {\n  width: 100%;\n  height: 100%;\n  border-radius: 50%;\n}\n\n.user-details {\n  flex: 1;\n}\n\n.nickname {\n  font-size: 18px;\n  color: #333;\n  font-weight: bold;\n  margin-bottom: 5px;\n}\n\n.other-info {\n  font-size: 14px;\n  color: #666;\n}\n\n.loading {\n  text-align: center;\n  margin: 20px;\n  color: #666;\n}\n\n.actions {\n  margin-top: 30px;\n  padding: 0 20px;\n}\n\nbutton {\n  margin-bottom: 15px;\n  background-color: #07c160;\n  color: #fff;\n  border-radius: 4px;\n  padding: 12px 0;\n  font-size: 16px;\n}\n\nbutton:active {\n  opacity: 0.8;\n}\n</style>\n","import MiniProgramPage from 'C:/Users/Msi/Desktop/wechatweb4/pages/index/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["defineComponent","getStoredUserInfo","uni","wechatAuth"],"mappings":";;;AA6BA,MAAA,YAAeA,8BAAA;AAAA,EACb,OAAI;AACF,WAAO;AAAA,MACL,UAAU;AAAA,MACV,SAAS;AAAA;EAEZ;AAAA,EACD,SAAM;AACJ,SAAK,eAAc;AAAA,EACpB;AAAA,EACD,SAAS;AAAA,IACD,iBAAc;;AAClB,YAAI;AACF,eAAK,UAAU;AAEf,gBAAM,aAAaC,sBAAAA;AACnB,cAAI,YAAY;AACdC,0BAAAA,MAAI,MAAM,OAAM,+BAA8B,CAAC;AAC/C,iBAAK,WAAW;AAChB,iBAAK,UAAU;AACf,mBAAM,QAAA,QAAA,IAAA;AAAA,UACR;AAGA,gBAAM,WAAW,MAAMC,sBAAAA;AACvBD,wBAAAA,MAAI,MAAM,OAAM,+BAA8B,CAAC;AAC/C,cAAI,UAAU;AACZ,iBAAK,WAAW;AAAA,UAClB;AAAA,QACA,SAAO,OAAO;AACdA,wBAAAA,MAAI,UAAU;AAAA,YACZ,OAAO;AAAA,YACP,MAAM;AAAA,UACP,CAAA;AACDA,wBAAG,MAAC,MAAM,SAAQ,+BAA8B,SAAS,KAAK;AAAA,QAChE,UAAU;AACR,eAAK,UAAU;AAAA,QACjB;AAAA,OACD;AAAA,IAAA;AAAA,IACD,cAAW;AACTA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK;AAAA,MACN,CAAA;AAAA,IACF;AAAA,IACD,gBAAa;AAEXA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO;AAAA,QACP,MAAM;AAAA,MACP,CAAA;AAAA,IACF;AAAA,EACF;CACF;;;;;;;;;;;;;;;;;AChFD,GAAG,WAAW,eAAe;"}